<%  items ||= record_object.send( association )
    nest_routes ||= false
    nest_in ||= record_object.class.name.underscore.to_sym
    fa ||= false
    attributes ||= nil
    show_add_button = true if show_add_button.nil?
    map_to ||= nil
    direct_to_edit = direct_to_edit.nil? ? nil : direct_to_edit
    # show_in ||= nil
    id_field_name = (record_object.class.name.underscore + "_id").to_sym
    default_actions ||= nil

    label ||= association.to_s.humanize

    new_item_path ||= url_for ( if nest_routes
                                  [ :new, record_object, association.to_s.singularize ]
                                elsif map_to
                                  [ :new, record_object, map_to]
                                elsif record_object.class.reflect_on_association(association).type.present?
                                  #therefore this is a polymorphic association
p :reflect_on_associationassociation
p record_object.class.reflect_on_association(association).foreign_key  
p record_object.class
p record_object.id                                
                                  [ :new,
                                    association.to_s.singularize,
                                    { record_object.class.reflect_on_association(association).foreign_key => record_object.id,
                                    record_object.class.reflect_on_association(association).type => record_object.class.to_s }
                                  ]
                                  # , new_item_path: url_for([:new, :variable, variable_consumer_id: @blueprint_version.id, variable_consumer_type: :BlueprintVersion])
                                else
                                  [ :new, association.to_s.singularize, id_field_name => record_object.id ]
                                end )



%>
<div class="col-sm-12">

  <div id="<%= record_object.class.to_s.underscore + '_' + association.to_s %>" class="panel panel-default">
    <div class="panel-body">
      <div class="col-sm-12">
        <h3><% if fa %><%= content_tag(:i , nil, class: "fa fa-#{fa}") + ' ' %><% end %><%= label %></h3>
        <% if show_add_button %>
          <%= link_to (content_tag(:i, nil, class: 'fa fa-plus').html_safe + " Add"), new_item_path, class: "btn btn-lg btn-primary trigger-response-modal" %>
        <% end %>
      </div>
      <%= render 'shared/index/table', items: items, nest_routes: nest_routes, nest_in: nest_in, map_to: map_to, attributes: attributes, direct_to_edit: direct_to_edit, default_actions: default_actions %>
    </div>
  </div>
</div>

